<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.TeamProject.mapper.ReviewMapper">

    <!-- 리뷰 등록 -->
    <insert id="insertReview" parameterType="com.example.TeamProject.model.Review"
            useGeneratedKeys="true" keyProperty="reviewNo">
        <selectKey keyProperty="reviewNo" resultType="int" order="BEFORE">
            SELECT REVIEW_SEQ.NEXTVAL FROM DUAL
        </selectKey>
        INSERT INTO REVIEW (
            REVIEW_NO, USER_ID, PRODUCT_NO, ORDER_ITEM_NO, RATING, CONTENT, CREATED_AT, RECOMMEND
        ) VALUES (
            #{reviewNo}, #{userId}, #{productNo}, #{orderItemNo}, #{rating}, #{content}, SYSDATE, 0
        )
    </insert>

    <!-- 리뷰 이미지 등록 -->
    <insert id="insertReviewImage" parameterType="com.example.TeamProject.model.ReviewImage">
        <selectKey keyProperty="imageNo" resultType="int" order="BEFORE">
            SELECT REVIEW_IMAGE_SEQ.NEXTVAL FROM DUAL
        </selectKey>
        INSERT INTO REVIEW_IMAGE (
            IMAGE_NO, REVIEW_NO, IMAGE_URL, CDATETIME, UDATETIME
        ) VALUES (
            #{imageNo}, #{reviewNo}, #{imageUrl}, SYSDATE, SYSDATE
        )
    </insert>

</mapper>